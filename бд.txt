SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

CREATE DATABASE customs WITH TEMPLATE = template0 ENCODING = 'UTF8' LOCALE_PROVIDER = libc LOCALE = 'Russian_Russia.1251';

ALTER DATABASE customs OWNER TO postgres;

\connect customs

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

CREATE TABLE public.unp (
    unp_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    unp character varying(255) NOT NULL,
    CONSTRAINT unp_pkey PRIMARY KEY (unp_id),
    CONSTRAINT uk9s68a7xrsb352dqfvkbfu74dm UNIQUE (unp)
);

ALTER TABLE public.unp OWNER TO postgres;

CREATE TABLE public.users (
    user_id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    created_at timestamp(6) without time zone NOT NULL,
    created_by character varying(255),
    activity_type character varying(255),
    email character varying(255),
    user_name character varying(255),
    password character varying(255) NOT NULL,
    role character varying(255) NOT NULL,
    username character varying(255) NOT NULL,
    verified boolean NOT NULL,
    unp bigint,
    updated_at timestamp(6) without time zone,
    CONSTRAINT users_pkey PRIMARY KEY (user_id),
    CONSTRAINT ukr43af9ap4edm43mmtq01oddj6 UNIQUE (username),
    CONSTRAINT fkeao7hadmm7s6kvhxrkhsmudlt FOREIGN KEY (unp)
        REFERENCES public.unp (unp_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT users_role_check CHECK (role::text = ANY (ARRAY['ADMIN'::character varying, 'CLIENT'::character varying, 'DRIVER'::character varying]::text[]))
);

ALTER TABLE public.users OWNER TO postgres;

CREATE TABLE public.activities (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    activity_date timestamp(6) without time zone,
    description character varying(255),
    user_id bigint NOT NULL,
    CONSTRAINT activities_pkey PRIMARY KEY (id),
    CONSTRAINT fkq6cjukylkgxdjkm9npk9va2f2 FOREIGN KEY (user_id)
        REFERENCES public.users (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

ALTER TABLE public.activities OWNER TO postgres;

CREATE TABLE public.declarations (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    country_of_destination character varying(255),
    country_of_origin character varying(255),
    created_at timestamp(6) without time zone,
    customs_office character varying(255),
    declaration_number character varying(255) NOT NULL,
    declaration_type character varying(255),
    net_weight numeric(38,2),
    product_description character varying(255),
    product_value numeric(38,2),
    quantity integer,
    reviewed_at timestamp(6) without time zone,
    status character varying(255),
    submitted_at timestamp(6) without time zone,
    tnved_code character varying(255),
    updated_at timestamp(6) without time zone,
    client_id bigint NOT NULL,
    CONSTRAINT declarations_pkey PRIMARY KEY (id),
    CONSTRAINT uk9axmgi6053jt92f9bn8ebihdn UNIQUE (declaration_number),
    CONSTRAINT fkfkfcuk388qcxjb3ctptvytipb FOREIGN KEY (client_id)
        REFERENCES public.users (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT declarations_status_check CHECK (status::text = ANY (ARRAY['PENDING'::character varying, 'UNDER_REVIEW'::character varying, 'APPROVED'::character varying, 'REJECTED'::character varying, 'SUSPENDED'::character varying]::text[]))
);

ALTER TABLE public.declarations OWNER TO postgres;

CREATE TABLE public.payments (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    amount numeric(38,2),
    created_at timestamp(6) without time zone,
    currency character varying(255),
    due_date date,
    paid_at timestamp(6) without time zone,
    payment_number character varying(255) NOT NULL,
    payment_type character varying(255),
    status character varying(255),
    client_id bigint NOT NULL,
    declaration_id bigint,
    CONSTRAINT payments_pkey PRIMARY KEY (id),
    CONSTRAINT ukc6nxg52ow66u8ut91bytspy64 UNIQUE (payment_number),
    CONSTRAINT fk9u5h829r12yfg6ptvtka0rqco FOREIGN KEY (declaration_id)
        REFERENCES public.declarations (id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT fkb7kq52yfgwdui0i641beqi2dp FOREIGN KEY (client_id)
        REFERENCES public.users (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION,
    CONSTRAINT payments_status_check CHECK (status::text = ANY (ARRAY['PENDING'::character varying, 'PAID'::character varying, 'OVERDUE'::character varying, 'CANCELLED'::character varying]::text[]))
);

ALTER TABLE public.payments OWNER TO postgres;

CREATE TABLE public.vehicles (
    id bigint NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1 ),
    capacity double precision,
    created_at timestamp(6) without time zone,
    license_plate character varying(255) NOT NULL,
    model character varying(255),
    vehicle_type character varying(255),
    year_of_manufacture integer,
    client_id bigint NOT NULL,
    CONSTRAINT vehicles_pkey PRIMARY KEY (id),
    CONSTRAINT uk9vovnbiegxevdhqfcwvp2g8pj UNIQUE (license_plate),
    CONSTRAINT fkblvagddu2q2y44h5bkjhq4g6g FOREIGN KEY (client_id)
        REFERENCES public.users (user_id) MATCH SIMPLE
        ON UPDATE NO ACTION
        ON DELETE NO ACTION
);

ALTER TABLE public.vehicles OWNER TO postgres;

